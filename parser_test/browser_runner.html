<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<script src="node_modules/diff/dist/diff.min.js"></script>
<script src="node_modules/rdflib/dist/rdflib.min.js"></script>
<script>
window.onload = () => {
  (async () => {
    let web = await import("./web_parser.js");
    web.init();

    let test = {
                  "file":"data/sioc.rdf",
                  "compare":"sorted_data/sioc_sorted.json",
                  "baseIri": "http://rdfs.org/sioc/ns#",
                  "iriMap": {
                  }
                };

    async function getData(file) {
      const response = await fetch(file);
      if (!response.ok)
        throw new Error("cannot fetch file: " + file);
      return await response.text();
    }

    try {
        const ext = test.file.substr(test.file.lastIndexOf(".") + 1);
        const data = await getData(test.file);
        const compare = await getData(test.compare);
        var result = await parser.transform(data, test.baseIri, parser.MimeExtMap[test], test.iriMap);
        result._comment = "Created with OWL2VOWL (version 0.3.7), http://vowl.visualdataweb.org";
        const diff = Diff.structuredPatch("parsed", "orig", JSON.stringify(sorter.sort(result), null, 2).trim(), compare.trim());
        if(diff.hunks.length)
          throw new Error(Diff.formatPatch(diff));
        console.log(test.file + ": ok");
    } catch(err){
        console.log("test for " + test.file + " failed with:");
        console.log(err.message);
    }
  })();




}

</script>
</head>
<body></body>
</html>
